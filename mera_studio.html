<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASHA STUDIO</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Cinzel', serif;
            background: linear-gradient(145deg, #1A1A1A, #0A0A0A);
            background-attachment: fixed;
            color: #E5E7EB;
        }
        .container {
            max-width: 1200px;
        }
        .btn {
            @apply px-4 py-2 rounded-lg font-medium transition-colors duration-300;
        }
        .btn-primary {
            @apply bg-red-600 text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2;
        }
        .btn-secondary {
            @apply bg-gray-700 text-gray-100 hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2;
        }
        .message-box {
            @apply p-4 mt-4 rounded-lg text-sm text-center;
        }
        .message-success {
            @apply bg-green-900 text-green-200;
        }
        .message-error {
            @apply bg-red-900 text-red-200;
        }
        .sidebar-link {
            @apply flex items-center p-4 rounded-lg text-gray-400 hover:bg-gray-700 hover:text-white transition-colors cursor-pointer;
        }
        .sidebar-link.active {
            @apply bg-gray-700 text-white;
        }
    </style>
</head>
<body class="bg-black text-gray-100">

    <div id="main-app" class="flex min-h-screen">
        <aside class="w-64 bg-gray-800 shadow-lg p-6 flex flex-col items-center">
            <div class="flex flex-col items-center mb-10">
                <img id="studio-logo" src="https://placehold.co/150x150/EF4444/FFFFFF?text=ASHA+STUDIO" alt="ASHA STUDIO Logo" class="h-24 w-24 object-cover rounded-full shadow-lg mb-4">
                <h1 class="text-xl font-extrabold text-center text-red-500">ASHA STUDIO</h1>
            </div>
            <nav class="w-full space-y-2">
                <a id="nav-my-videos" class="sidebar-link active">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
                    </svg>
                    <span>मेरी वीडियो गैलरी</span>
                </a>
                <a id="nav-profile" class="sidebar-link">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                    </svg>
                    <span>मेरी प्रोफ़ाइल</span>
                </a>
                <a id="nav-about" class="sidebar-link">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    <span>हमारे बारे में</span>
                </a>
                <a id="nav-packages" class="sidebar-link">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h10M4 4h16a2 2 0 012 2v12a2 2 0 01-2 2H4a2 2 0 01-2-2V6a2 2 0 012-2z" />
                    </svg>
                    <span>हमारे पैकेज</span>
                </a>
            </nav>
        </aside>

        <main class="flex-1 p-6 md:p-10">
            <div id="video-gallery" class="w-full">
                <div class="bg-gray-800 rounded-xl shadow-xl p-6 md:p-8 mb-8">
                    <h2 class="text-2xl font-bold text-red-400 mb-4">वीडियो अपलोड करें</h2>
                    <form id="upload-form" class="space-y-4">
                        <div class="border border-dashed border-gray-600 p-6 rounded-xl text-center mb-6">
                            <input type="file" id="video-file-input" accept="video/*" class="w-full text-sm text-gray-300 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-gray-700 file:text-gray-100 hover:file:bg-gray-600">
                            <button type="submit" id="upload-btn" class="btn btn-primary w-full mt-4" disabled>अपलोड शुरू करें</button>
                        </div>
                    </form>
                    <div id="progress-container" class="w-full bg-gray-700 rounded-full h-2.5 hidden">
                        <div id="progress-bar" class="bg-red-600 h-2.5 rounded-full" style="width: 0%"></div>
                    </div>
                </div>
                
                <div id="status-message" class="message-box hidden"></div>

                <div id="video-list-container" class="mt-8">
                    <h2 class="text-2xl font-bold text-red-400 mb-4">अपलोड किए गए वीडियो</h2>
                    <div id="video-list" class="space-y-4">
                        <div id="loading-message" class="text-center text-gray-400">वीडियो लोड हो रहे हैं...</div>
                    </div>
                </div>
            </div>

            <div id="profile-page" class="w-full hidden">
                <div class="bg-gray-800 rounded-xl shadow-xl p-6 md:p-8">
                    <h2 class="text-2xl font-bold text-red-400 mb-4">मेरी प्रोफ़ाइल</h2>
                    <p class="text-gray-300 mb-4">यह सेक्शन केवल आपके लिए है। यहां आप अपनी प्रोफ़ाइल जानकारी देख सकते हैं।</p>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-gray-400 text-sm font-medium mb-1">नाम</label>
                            <input type="text" value="आपका नाम" class="w-full p-3 rounded-lg bg-gray-700 text-gray-100 border border-gray-600 focus:outline-none focus:ring-2 focus:ring-red-500">
                        </div>
                        <div>
                            <label class="block text-gray-400 text-sm font-medium mb-1">ईमेल</label>
                            <input type="email" value="your.email@example.com" class="w-full p-3 rounded-lg bg-gray-700 text-gray-100 border border-gray-600 focus:outline-none focus:ring-2 focus:ring-red-500">
                        </div>
                        <button class="btn btn-primary w-full">प्रोफ़ाइल अपडेट करें</button>
                    </div>
                </div>
            </div>

            <div id="about-page" class="w-full hidden">
                <div class="bg-gray-800 rounded-xl shadow-xl p-6 md:p-8">
                    <h2 class="text-2xl font-bold text-red-400 mb-4">हमारे बारे में</h2>
                    <div class="space-y-4 text-gray-300">
                        <p>ASHA STUDIO में आपका स्वागत है! हम एक पेशेवर वीडियो निर्माण स्टूडियो हैं जो शादी के वीडियो, कॉर्पोरेट फ़िल्मों, संगीत वीडियो और अन्य रचनात्मक परियोजनाओं में विशेषज्ञता रखते हैं। हमारा लक्ष्य हर कहानी को कलात्मक और यादगार बनाना है।</p>
                        <p class="mt-4">
                            <strong class="text-white">Instagram:</strong>
                            <a href="https://www.instagram.com/ashastudio_official" target="_blank" class="text-red-400 hover:text-red-500 underline">@ashastudio_official</a>
                        </p>
                        <p>
                            <strong class="text-white">Contact No.:</strong> <span>+91 9876543210</span>
                        </p>
                    </div>
                </div>
            </div>

            <div id="packages-page" class="w-full hidden">
                <div class="bg-gray-800 rounded-xl shadow-xl p-6 md:p-8">
                    <h2 class="text-2xl font-bold text-red-400 mb-4">हमारे पैकेज</h2>
                    <p class="text-gray-300 mb-6">यहाँ हमारे द्वारा दिए जाने वाले कुछ प्रमुख पैकेज दिए गए हैं। हम आपकी ज़रूरतों के अनुसार कस्टम पैकेज भी बनाते हैं।</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="bg-zinc-700 p-6 rounded-xl shadow-md">
                            <h3 class="text-xl font-bold text-white mb-2">शुरुआती पैकेज</h3>
                            <p class="text-gray-400 mb-4">छोटे प्रोजेक्ट और व्यक्तिगत उपयोग के लिए आदर्श।</p>
                            <ul class="list-disc list-inside text-gray-300 space-y-1">
                                <li>15 मिनट का वीडियो</li>
                                <li>एक-दिवसीय शूटिंग</li>
                                <li>लाइट कलर ग्रेडिंग</li>
                            </ul>
                            <div class="mt-4 text-white text-lg font-semibold">₹15,000</div>
                        </div>

                        <div class="bg-zinc-700 p-6 rounded-xl shadow-md">
                            <h3 class="text-xl font-bold text-white mb-2">पेशेवर पैकेज</h3>
                            <p class="text-gray-400 mb-4">पेशेवर शूट और इवेंट्स के लिए सबसे लोकप्रिय पैकेज।</p>
                            <ul class="list-disc list-inside text-gray-300 space-y-1">
                                <li>60 मिनट का वीडियो</li>
                                <li>दो-दिवसीय शूटिंग</li>
                                <li>पेशेवर कलर ग्रेडिंग और साउंड मिक्सिंग</li>
                            </ul>
                            <div class="mt-4 text-white text-lg font-semibold">₹40,000</div>
                        </div>

                        <div class="bg-zinc-700 p-6 rounded-xl shadow-md">
                            <h3 class="text-xl font-bold text-white mb-2">सिनेमाई पैकेज</h3>
                            <p class="text-gray-400 mb-4">प्रीमियम, सिनेमाई अनुभव के लिए सबसे बेहतरीन विकल्प।</p>
                            <ul class="list-disc list-inside text-gray-300 space-y-1">
                                <li>अनलिमिटेड वीडियो टाइम</li>
                                <li>बहु-दिवसीय शूटिंग</li>
                                <li>ड्रोन और जिम्बल शूट शामिल</li>
                            </ul>
                            <div class="mt-4 text-white text-lg font-semibold">₹75,000+</div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <div id="playback-modal" class="fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center p-4 z-50 hidden">
        <div class="relative w-full max-w-4xl">
            <button id="close-modal-btn" class="absolute -top-2 -right-2 bg-white rounded-full p-1 shadow-lg text-gray-700 hover:bg-gray-200 transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
            <video id="modal-video" controls controlsList="nodownload" class="w-full h-auto rounded-lg shadow-2xl"></video>
        </div>
    </div>

    <script>
        // Cloudinary Credentials
        const CLOUDINARY_CLOUD_NAME = 'dnxbxatyi';
        const CLOUDINARY_UPLOAD_PRESET = 'asha_studio_upload';
        const CLOUDINARY_API_KEY = '937539385933469'; // आपकी Cloudinary API key यहाँ आएगी

        // --- UI Elements ---
        const videoFileInput = document.getElementById('video-file-input');
        const uploadBtn = document.getElementById('upload-btn');
        const progressContainer = document.getElementById('progress-container');
        const progressBar = document.getElementById('progress-bar');
        const statusMessage = document.getElementById('status-message');
        const videoList = document.getElementById('video-list');
        const loadingMessage = document.getElementById('loading-message');
        const modal = document.getElementById('playback-modal');
        const modalVideo = document.getElementById('modal-video');
        const closeModalBtn = document.getElementById('close-modal-btn');
        
        // Navigation elements
        const navMyVideos = document.getElementById('nav-my-videos');
        const navProfile = document.getElementById('nav-profile');
        const navAbout = document.getElementById('nav-about');
        const navPackages = document.getElementById('nav-packages');
        const videoGallerySection = document.getElementById('video-gallery');
        const profilePageSection = document.getElementById('profile-page');
        const aboutPageSection = document.getElementById('about-page');
        const packagesPageSection = document.getElementById('packages-page');

        // --- Function to show a temporary message ---
        function showStatus(message, type = 'success') {
            statusMessage.textContent = message;
            statusMessage.classList.remove('hidden', 'message-success', 'message-error');
            statusMessage.classList.add(type === 'success' ? 'message-success' : 'message-error');
            statusMessage.style.display = 'block';
            setTimeout(() => {
                statusMessage.style.display = 'none';
            }, 5000);
        }
        
        // --- Function to fetch and display video list ---
        async function fetchVideoList() {
            videoList.innerHTML = '';
            loadingMessage.classList.remove('hidden');

            try {
                const response = await fetch('http://localhost:3000/videos');
                
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }

                const videos = await response.json();
                
                loadingMessage.classList.add('hidden');

                if (videos && videos.length > 0) {
                    videos.forEach(video => {
                        addVideoToList(video.public_id, video.secure_url);
                    });
                } else {
                    videoList.innerHTML = '<div class="text-center text-gray-400">कोई वीडियो नहीं मिला। कृपया एक वीडियो अपलोड करें।</div>';
                }
            } catch (error) {
                loadingMessage.classList.add('hidden');
                console.error('Error fetching videos:', error);
                videoList.innerHTML = '<div class="text-center text-red-400">वीडियो लोड करने में त्रुटि।</div>';
            }
        }
        
        // --- Show/hide sections
        function showSection(sectionId) {
            videoGallerySection.classList.add('hidden');
            profilePageSection.classList.add('hidden');
            aboutPageSection.classList.add('hidden');
            packagesPageSection.classList.add('hidden');
            document.getElementById(sectionId).classList.remove('hidden');
        }

        // --- Set active navigation link
        function setActiveLink(activeLink) {
            document.querySelectorAll('.sidebar-link').forEach(link => {
                link.classList.remove('active');
            });
            activeLink.classList.add('active');
        }

        // --- Handle Video Upload to Cloudinary ---
        async function handleUpload(file) {
            if (!CLOUDINARY_CLOUD_NAME || !CLOUDINARY_UPLOAD_PRESET) {
                showStatus("कृपया Cloudinary जानकारी जोड़ें!", "error");
                return;
            }
            
            uploadBtn.disabled = true;
            videoFileInput.disabled = true;
            progressContainer.classList.remove('hidden');
            showStatus("वीडियो अपलोड हो रहा है...", "info");

            const formData = new FormData();
            formData.append('file', file);
            formData.append('upload_preset', CLOUDINARY_UPLOAD_PRESET);

            const xhr = new XMLHttpRequest();
            xhr.open('POST', `https://api.cloudinary.com/v1_1/${CLOUDINARY_CLOUD_NAME}/video/upload`, true);

            xhr.upload.addEventListener('progress', (e) => {
                const progress = (e.loaded / e.total) * 100;
                progressBar.style.width = progress + '%';
            });

            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4) {
                    if (xhr.status === 200) {
                        const data = JSON.parse(xhr.responseText);
                        showStatus('वीडियो सफलतापूर्वक अपलोड हो गया है!');
                        fetchVideoList(); // Refresh the video list automatically
                    } else {
                        try {
                            const errorData = JSON.parse(xhr.responseText);
                            showStatus('अपलोड में त्रुटि: ' + (errorData.error.message || 'Unknown error'), 'error');
                        } catch (e) {
                            showStatus('अपलोड में अज्ञात त्रुटि।', 'error');
                        }
                    }
                    
                    resetUploadUI();
                }
            };

            xhr.send(formData);
        }

        // --- Reset Upload UI after completion or error ---
        function resetUploadUI() {
            uploadBtn.disabled = true;
            videoFileInput.disabled = false;
            videoFileInput.value = '';
            progressContainer.classList.add('hidden');
            progressBar.style.width = '0%';
        }

        // --- Create a list item for each video ---
        function addVideoToList(name, url) {
            const videoItem = document.createElement('div');
            videoItem.className = 'flex items-center justify-between bg-zinc-700 p-4 rounded-lg shadow-sm';
            videoItem.innerHTML = `
                <div class="flex-1 min-w-0">
                    <p class="font-medium text-gray-100 truncate">${name}.mp4</p>
                </div>
                <div class="flex space-x-2 ml-4">
                    <button class="btn btn-secondary text-sm play-btn" data-url="${url}">
                        वीडियो देखें
                    </button>
                    <button class="btn btn-primary text-sm share-btn" data-link="${url}">
                        लिंक कॉपी करें
                    </button>
                </div>
            `;
            videoList.appendChild(videoItem);

            const playBtn = videoItem.querySelector('.play-btn');
            const shareBtn = videoItem.querySelector('.share-btn');

            playBtn.addEventListener('click', () => {
                modalVideo.src = playBtn.dataset.url;
                modal.classList.remove('hidden');
                modalVideo.play();
            });

            shareBtn.addEventListener('click', (e) => {
                e.preventDefault();
                copyToClipboard(shareBtn.dataset.link);
            });
        }

        // --- Copy to Clipboard Function ---
        function copyToClipboard(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            document.body.appendChild(textarea);
            textarea.select();
            try {
                document.execCommand('copy');
                showStatus("लिंक कॉपी हो गया!");
            } catch (err) {
                console.error('Failed to copy text:', err);
                showStatus("लिंक कॉपी करने में विफल।", "error");
            }
            document.body.removeChild(textarea);
        }

        // --- Event Listeners ---
        videoFileInput.addEventListener('change', () => {
            if (videoFileInput.files.length > 0) {
                uploadBtn.disabled = false;
            } else {
                uploadBtn.disabled = true;
            }
        });

        uploadBtn.addEventListener('click', (e) => {
            e.preventDefault();
            const file = videoFileInput.files[0];
            if (file) {
                handleUpload(file);
            }
        });
        
        closeModalBtn.addEventListener('click', () => {
            modal.classList.add('hidden');
            modalVideo.pause();
            modalVideo.src = '';
        });

        navMyVideos.addEventListener('click', () => {
            showSection('video-gallery');
            setActiveLink(navMyVideos);
            fetchVideoList(); // Load videos when the gallery is opened
        });

        navProfile.addEventListener('click', () => {
            showSection('profile-page');
            setActiveLink(navProfile);
        });

        navAbout.addEventListener('click', () => {
            showSection('about-page');
            setActiveLink(navAbout);
        });

        navPackages.addEventListener('click', () => {
            showSection('packages-page');
            setActiveLink(navPackages);
        });
        
        const modalVideoElement = document.getElementById('modal-video');
        modalVideoElement.addEventListener('contextmenu', e => e.preventDefault());

        // Initial load of video list
        document.addEventListener('DOMContentLoaded', fetchVideoList);
    </script>
</body>
</html>